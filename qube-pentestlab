#!/bin/bash

# Define the directory for pentesting tools
pentest_dir="$HOME/pentest_tools"

# Create a directory for the pentesting lab and navigate to it
mkdir -p $pentest_dir
cd $pentest_dir

# Function to install tools from BlackArch
install_blackarch_tools() {
    echo "Installing BlackArch tools..."
    sudo pacman -S --noconfirm $@
}

# Function to install Python packages
install_python_packages() {
    echo "Installing Python packages..."
    pip install $@
}

# Function to clone and install tools from GitHub
install_github_tool() {
    echo "Cloning and installing $1 from GitHub..."
    git clone $2
    cd $1
    sudo make install
    cd $pentest_dir
}

# Function to create desktop entries
create_desktop_entry() {
    local tool_name="$1"
    local executable_path="$2"
    local icon_path="$3"

    cat > "$HOME/.local/share/applications/$tool_name.desktop" <<EOL
[Desktop Entry]
Name=$tool_name
Exec=$executable_path
Icon=$icon_path
Type=Application
Categories=Security;PenTest;
EOL

    chmod +x "$HOME/.local/share/applications/$tool_name.desktop"
}

# Update the system and install essential packages
echo "Updating the system and installing essential packages..."
sudo pacman -Syu --noconfirm
sudo pacman -S --noconfirm git wget curl python3 python-pip

# Install development tools and libraries
echo "Installing development tools and libraries..."
sudo pacman -S --noconfirm base-devel libxml2 libxslt sqlite openssl libffi

# Install specific pentesting tools from BlackArch
install_blackarch_tools sqlmap masscan nikto wpscan dirb hydra burp arachni

# Install Python packages
install_python_packages requests

# Install reNgine
echo "Installing reNgine..."
git clone https://github.com/yogeshojha/rengine.git
cd rengine
pip install -r requirements.txt
sudo chmod +x setup.sh
./setup.sh
cd $pentest_dir

# Create desktop entries for the installed tools
create_desktop_entry "reNgine" "$pentest_dir/rengine/rengine.py" "/path/to/rengine-icon.png"

# Tools grouped by type

# Web Application Testing Tools
install_blackarch_tools gobuster dirsearch commix sqlmap-noarkmap no-sqlmap burpsuite zaproxy aquatone

# Network Tools
install_blackarch_tools networkminer paros pig cirt-fuzzer aslookup nmap aircrack-ng nipe habu scapy amass scilla

# Forensic Tools
install_blackarch_tools autopsy sleuthkit malzilla caine

# Cryptography Tools
install_blackarch_tools xortool john ripper aircrack ciphey

# Post-Exploitation Tools
install_blackarch_tools empire silenttrinity powersploit ebowla

# Subdomain Enumeration Tools
install_blackarch_tools sublist3r massdns findomain chaos-client domained shuffledns censys-subdomain-finder
install_blackarch_tools turbolist3r censys-enumeration tugarecon as3nt subra substr3am domain altdns brutesubs
install_blackarch_tools dns-parallel-prober dnscan knock hakrevdns dnsx subfinder assetfinder crtndstry vhostscan
install_blackarch_tools scilla sub3suite cero

# Port Scanning Tools
install_blackarch_tools masscan rustscan naabu nmap sandmap scancannon

# Screenshot Tools
install_blackarch_tools eyewitness aquatone screenshoteer gowitness witnessme eyeballer scrying depix
install_blackarch_tools httpscreenshot

# Technology Identification Tools
install_blackarch_tools wappalyzer webanalyze python-builtwith whatweb retire.js httpx fingerprintx

# Content Discovery Tools
install_blackarch_tools gobuster recursebuster feroxbuster dirsearch dirsearch-golang filebuster dirstalk
install_blackarch_tools dirbuster-ng gospider hakrawler crawley

# Links-Related Tools
install_blackarch_tools linkfinder js-scan linksdumper golinkfinder burpjslinkfinder urlgrab waybackurls gau
install_blackarch_tools getjs linx

# Parameter-Related Tools
install_blackarch_tools parameth param-miner parampampam arjun paramspider x8

# Fuzzing Tools
install_blackarch_tools wfuzz ffuf fuzzdb intruderpayloads fuzzilli fuzzapi qsfuzz vaf

# Exploitation Tools
install_blackarch_tools commix corsy cors-test cors-scanner corsme crlfsuite crlfuzz crlf-injection-scanner
install_blackarch_tools xsrfprobe dotdotpwn fdsploit off-by-slash liffier liffy burp-lfi-tests lfi-enum lfi-suite
install_blackarch_tools lfi-files graphqlmap inql graphqlmap shapeshifter graphql_beautifier clairvoyance
install_blackarch_tools headi ysoserial gadgetprobe ysoserial.net phpggc inql graphqlmap
install_blackarch_tools autorize oralyzer injectus dom-red openredirex razzer racepwn requests-racer turbo-intruder
install_blackarch_tools race-the-web http-request-smuggling smuggler h2csmuggler tiscripts

# Server Side Request Forgery (SSRF) Tools
install_blackarch_tools ssrfmap gopherus ground-control ssrfire httprebind ssrf-sheriff b-xssrf extended-ssrf-search
install_blackarch_tools gaussrf ssrfdetector grafana-ssrf sentryssrf lorsrf singularity whonow dns-rebind-toolkit
install_blackarch_tools dref rbndr httprebind dnsfookup

# SQL Injection Tools
install_blackarch_tools sqlmap nosqlmap sqliscanner sleuthql mssqlproxy sqli-hunter waybacksqli
install_blackarch_tools esc evil-sql-client mssqli-duet burp-to-sqlmap burpsqltruncsanner andor blinder sqliv nosqli

# XSS Injection Tools
install_blackarch_tools xssstrike xssor2 xsscrapy sleepy-puppy ezxss xsshunter dalfox xsser xsspear weaponised-xss-payloads
install_blackarch_tools xsshunter fast-xss-scanner lightbulb xssfinder xssmage xss-shell wafw00f xssor xsssniper xsssniffer
install_blackarch_tools xsshell xssdumper brutesploit jexboss

# NoSQL Injection Tools
install_blackarch_tools nosqli jok3r nosqlmap nosqli-hunter jsonql nosql-extract nosql-bongo jnosql jnosqlp ynosql
install_blackarch_tools nosqli-injection cjsontruder mssqli-nosqli-track odat got-your-mongo nosql-payload
install_blackarch_tools burp-nosqli crocodilehunter python-pentesting qnosql nosqli-injection

# Web Application Firewall (WAF) Tools
install_blackarch_tools sqlmap blacksheep burp-vulners-scanner json-scan wafio wafninja fuzzapi

# Web Proxy Tools
install_blackarch_tools burpsuite owtf webscarab mitmproxy burp2-zap burp2http2 l7mp

# SQL Database Tools
install_blackarch_tools sqlcipher sqlninja sqldict pymsql sqlline sequel

# Networking Tools
install_blackarch_tools tcpdump tshark wireshark wireshark-cli tcpick dsniff dsniff-web plugin-dnp3
install_blackarch_tools sidguesser pcapfix traceproto autovpn repeater pipessh eviltwin dnsspoof mitmf mfoc
install_blackarch_tools proxystrike devor magic-wormhole gplaycli nipe darkdns zizzania aforgery

# Password Cracking Tools
install_blackarch_tools john johnny hash-identifier johnny-john-hashcat tsak kraken jok3r edpr lennox ciscot7
install_blackarch_tools passnow rcracki johnny-gui krb5parse johnny-burst

# Wireless Tools
install_blackarch_tools aircrack-ng nipe wifiphisher rescap asleap pixiewps nesad killerbee atesttest aircrack-ptw
install_blackarch_tools snow ptw huntr asleap aircrack-ptw crackers can-recover cowpatty

# Protocol Analysis Tools
install_blackarch_tools scapy tcpcrypt

# ARP Poisoning Tools
install_blackarch_tools arpspoof arpon arpwatch ifdown-gateway ifstat arp-scan arpalert net-sniffnet etherape ettercap
install_blackarch_tools driftnet bettercap dsniff-mitm dsniff-dragent sslstrip dsniff-dnsspoof jdsniff monkey-in-the-middle
install_blackarch_tools pandorafms-console pandorafms-server netsniff-ng spyonet visortool bettercap parallelpwn

# Vulnerability Analysis Tools
install_blackarch_tools nikto openvas cvechecker

# Post-Exploitation Tools
install_blackarch_tools metasploit pure-ftpd-scripts doona exploit-db xspy setoolkit lnk2pwn kitsune-badger adcsmb mimikatz
install_blackarch_tools smbexec responder unicorn proxysploit metasploit-framework

# Reverse Engineering Tools
install_blackarch_tools radare2 firmware-mod-kit binwalk firmadyne sigmakey firmwalker krill recoverjpeg testdisk
install_blackarch_tools gddrescue rekall beaglesight sdlerner sdfork randoop

# Memory Analysis Tools
install_blackarch_tools volatility volatility-plugins dmp2map yaraprocessor voltron rekall makethemshell extensionstream
install_blackarch_tools gcore vmat framework gsb sahara gsa regshot memoryze vm2dmg plasmarc greek

# Forensics Tools
install_blackarch_tools oledump-office-dumper oletools paratrace volatility-plugins iosforensics elmo emacsforpentester
install_blackarch_tools fls ntfs-3g nfs-utils

# Anti-Forensics Tools
install_blackarch_tools timestomp winlockpwn winlockpwn-build winlockpwn-winlockpwn-backdoorconfig

# Steganography Tools
install_blackarch_tools stegpy iocextract stegsnow mp3stego gsm-length-replace stegeasy whitespacetruffle pymp3stego
install_blackarch_tools quickstego stegtools blindjpeg pngtools exifprobe stegdetect f5steganography jsteg pdf-parser
install_blackarch_tools xsteg exif rensensteg rbndr go-jose gosta fpc stegfs jpeg-xr hybstegosaurus steganographer
install_blackarch_tools outguess neflabs-stegcracker git-stegano gifshuffle jsontool decode-arrow angr-jupylet jpseek

# Malware Analysis Tools
install_blackarch_tools oletools peepdf maltrieve pyew redsocks cland malwaremalorie virustotal-cli cutycapt
install_blackarch_tools noriben minidump-processor peepdf corkscrew webmitm python-excel-ole reconnoitre shellcode2exe
install_blackarch_tools any2file wfpadclient multimuter malcom lazagne mimipenguin dnsrecon-evolux meowd woraw trojita
install_blackarch_tools staticlogger fridaserver frida-agent frida-extractor frida hookets crook foref malheur
install_blackarch_tools machomachomangler radare2 pic usbrip hccap2wpa

# Malware Reverse Engineering Tools
install_blackarch_tools capstone python-capstone pwndbg peda libdasm libemu yara yar-tools yara-python libmagic sagma
install_blackarch_tools melkor malzilla vba2graph hiew malware-analysis-dataset webexp recordm-core corte-metadados-wiki
install_blackarch_tools peepdf peframe zerowine xpedite pdf-resume-reader

# Malware Signature Identification Tools
install_blackarch_tools yarasign yarascanner yara-python-clamav-code yaraexplain ssdeep doc-identifier exif-identifier
install_blackarch_tools winnow-modules ipproto guypot gtkhash lynis

# Browser Exploitation Tools
install_blackarch_tools xspy driftnet eletorpedb raptor magic-meltdown xspy pitr

# Hardware Hacking Tools
install_blackarch_tools proxystrike devor zizzania aforgery

# Shellcode Development Tools
install_blackarch_tools radare2 sigmakey binwalk testdisk r2dec pdftool gittools xortool shellcode-tool shellcode2exe

# Wireless Security Tools
install_blackarch_tools mdk3 aircrack-ng fern-wifi-cracker websploit wifite bully coWPAtty pixiewps nesad reaver
install_blackarch_tools mdk4 airgeddon wfite evilap-git framux giskismet wavemon nipe wifi-monitor fluxion iw-memopass

# Wireless Spectrum Analysis Tools
install_blackarch_tools kismet wifiphisher

# Install and configure hardware hacking tools

install_blackarch_tools fpgasploit fpgainfo gnuradio tct certfuzz wesside-ng hackrf rfcat kismet ultrasonic
install_blackarch_tools spectool uscrack-decancer gsm-sms-hijack arduino sketch-builder lvds oscanner
